# =========================
# OpenSearch
# =========================
OS_HOST=192.168.227.128
OS_PORT=9200
OS_USER=admin
OS_PASS=admin
OS_SSL=true
OS_VERIFY_CERTS=false
OS_TIMEOUT=20

# =========================
# Indices
# =========================
WAZUH_ALERTS_INDEX=wazuh-alerts-*
RBA_ALERT_INDEX=rba-alerts-*
RBA_STATE_INDEX=rba-entity-state
RBA_SNAP_INDEX=rba-risk-snapshots-*
RBA_CASES_INDEX=rba-cases
RBA_CASES_LOCAL_FILE=rba_cases.json

# =========================
# Timestamp fields
# =========================
WAZUH_TS_FIELD=timestamp
RBA_TS_FIELD=@timestamp
RBA_SNAP_TS_FIELD=@timestamp

# =========================
# RBA Compute Engine
# =========================
RBA_TIME_WINDOW_HOURS=24
RBA_HALF_LIFE_MINUTES=120
RBA_QUERY_SIZE=2000

# --- Baseline / Threshold Logic ---
RBA_BASELINE_WINDOW_HOURS=72
RBA_K_SIGMA=2.0
RBA_BASELINE_MIN_SNAPSHOTS=30
RBA_MIN_SIGMA=0.1

# --- Threshold Stabilization / Self-Healing ---
RBA_MAX_SIGMA_MULTIPLIER=2.5
RBA_THRESHOLD_DECAY=0.97
RBA_MIN_THRESHOLD=5
RBA_USE_DECAYED_THRESHOLD=true

# --- Alert Gating ---
RBA_DELTA_MIN=1.0
RBA_ALERT_COOLDOWN_MINUTES=60
RBA_TOP_CONTRIBUTORS=5
RBA_MAX_ALERTS_PER_RUN=20

# =========================
# Dashboard
# =========================
RBA_DEBUG=1
RBA_RANK_MODE=ratio
RBA_PIPELINE_STALE_MINUTES=30
